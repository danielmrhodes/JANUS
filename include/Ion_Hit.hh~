#ifndef Ion_Hit_h
#define Ion_Hit_h 1

#include "G4VHit.hh"
#include "G4THitsCollection.hh"
#include "G4Allocator.hh"
#include "G4ThreeVector.hh"

class Ion_Hit : public G4VHit {
  
public:

  Ion_Hit();
  ~Ion_Hit();

  inline void* operator new(size_t);
  inline void operator delete(void *aHit);

  inline void SetEdep(G4double de) {edep = de;}
  inline void SetPos(G4ThreeVector vec) {pos = vec;}
  void SetSeg(G4int id);
  
  G4double GetEdep() const {return edep;}
  G4ThreeVector GetPos() const {return pos;}
 
  G4int GetRing() const {return ring;}
  G4int GetSector() const {return sector;}
  G4int GetDetector() const {return det;}
  
  //void Draw() const;
  //void Print() const;
  
private:
  
  G4double edep;
  G4ThreeVector pos;

  G4int det, ring, sector;

};

typedef G4THitsCollection<Ion_Hit> Ion_Hit_Collection;

extern G4Allocator<Ion_Hit>* Ion_Hit_Allocator;

inline void* Ion_Hit::operator new(size_t) {
  
  if(!Ion_Hit_Allocator) {
    Ion_Hit_Allocator = new G4Allocator<Ion_Hit>;
  }
  
  return (void*)Ion_Hit_Allocator->MallocSingle();
}

inline void Ion_Hit::operator delete(void* aHit) {
  Ion_Hit_Allocator->FreeSingle((Ion_Hit*)aHit);
}

#endif
